<div class="form-container">
  <div class="header">
    <div class="title">
      <h2>Upload a new video</h2>
    </div>
    <div class="close">
      <mat-icon mat-dialog-close class="material-icons">close</mat-icon>
    </div>
  </div>
  <form>
    <div class="modal-body">
      <!-- radio  -->
      <div class="radio-block" *ngIf="member_type !== 'player'">
        <mat-radio-group>
          <mat-radio-button checked value="Timeline video">
            Timeline video
          </mat-radio-button>
          <mat-radio-button value="Learning or training video">
            Learning or training video
          </mat-radio-button>
          <mat-radio-button value="Match video">
            Match video
          </mat-radio-button>
        </mat-radio-group>
      </div>
      <!-- steps -->
      <div class="stepper">
        <div class="steps active">
          <div class="icon">
            <mat-icon class="material-icons">
              video_call
            </mat-icon>
          </div>
          <p>Perform a skill and record a video</p>
        </div>
        <div class="steps steps-line active">
          <div class="icon" (click)="setStep(steps.selectVideo)">
            <mat-icon class="material-icons">
              av_timer
            </mat-icon>
          </div>
          <p>Upload a video of length upto {{ getUploadVideoLength() }} mins</p>
        </div>
        <div
          class="steps steps-line"
          [ngClass]="{ active: currentStep === 'tags' }"
        >
          <div class="icon" (click)="setStep(steps.tags)">
            <mat-icon class="material-icons">
              trending_up
            </mat-icon>
          </div>
          <p>Tag upto 2 abilities and 3 attributes each</p>
        </div>
      </div>
      <form [formGroup]="createVideoPostForm">
        <ng-container *ngIf="currentStep === 'tags'">
          <!-- ability -->
          <div class="ability-wrapper">
            <div class="btn-group mb-2">
              <ng-container *ngFor="let ability of tagsArray">
                <button
                  [ngClass]="
                    selectedAbilityIdList.includes(ability?.ability)
                      ? 'btn-active'
                      : ''
                  "
                  (click)="toggleSelection(ability.ability)"
                >
                  {{ ability.ability_name }}
                </button>
              </ng-container>
              <button>Other</button>
            </div>
          </div>
          <!-- Attribute wrapper -->
          <div class="attribute-wrapper">
            <ul class="attribute-items">
              <ng-container
                *ngFor="
                  let ability of this.createVideoPostForm.get('tags')[
                    'controls'
                  ];
                  let i = index
                "
                formArrayName="tags"
              >
                <ng-container
                  *ngIf="
                    ability.get('ability').value === selectedAbility.ability
                  "
                >
                  <ng-container [formGroupName]="i">
                    <ng-container
                      *ngFor="
                        let attribute of ability.get('attributes')['controls'];
                        let j = index
                      "
                      formArrayName="attributes"
                    >
                      <ng-container [formGroupName]="j">
                        <li>
                          <mat-checkbox
                            formControlName="attribute"
                            [value]="attribute.get('attribute').id"
                            >{{
                              attribute.get('attribute_name').value
                            }}</mat-checkbox
                          >
                        </li>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </ng-container>
            </ul>
          </div>
        </ng-container>

        <ng-container *ngIf="currentStep === 'selectVideo'">
          <!-- video -->
          <div class="upload-wrapper" *ngIf="media === null">
            <div class="upload">
              <div class="video-upload">
                <span class="upload-video">
                  <label for="upload"
                    >Select a video
                    <input
                      formControlName="media"
                      type="file"
                      id="upload"
                      (change)="uploadVideo($event.target.files)"
                    />
                  </label>
                </span>
              </div>
            </div>
          </div>
        </ng-container>
        <ng-container *ngIf="media !== null">
          <div class="upload-wrapper">
            <div class="upload">
              <img src="assets/images/member/video-placeholder.png" alt="" />

              <div class="uploader">
                <mat-progress-bar
                  mode="determinate"
                  value="40"
                ></mat-progress-bar>
                <span>Uploaded 40%</span>
              </div>
            </div>
          </div>
        </ng-container>
      </form>
    </div>
    <div class="modal-footer">
      <!-- actions -->
      <div class="action-block">
        <div class="btn-group">
          <button class="btn-normal" mat-dialog-close>Cancel</button>
          <button
            [disabled]="!createVideoPostForm.valid"
            (click)="createVideoPost()"
            class="btn-active"
          >
            Save
          </button>
        </div>
      </div>
    </div>
  </form>
</div>
